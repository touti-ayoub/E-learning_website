<div class="create-challenge-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Créer un nouveau Challenge</mat-card-title>
      <mat-card-subtitle>
        {{currentUser}} | {{currentDate}}
      </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="challengeForm" (ngSubmit)="onSubmit()" class="challenge-form">
        <!-- Nom du challenge -->
        <mat-form-field appearance="outline">
          <mat-label>Nom du challenge</mat-label>
          <input matInput formControlName="name" placeholder="Entrez le nom du challenge">
          <mat-error *ngIf="challengeForm.get('name')?.invalid">
            {{getErrorMessage('name')}}
          </mat-error>
        </mat-form-field>

        <!-- Description -->
        <mat-form-field appearance="outline">
          <mat-label>Description</mat-label>
          <textarea matInput formControlName="description" rows="4" 
                    placeholder="Décrivez le challenge"></textarea>
          <mat-error *ngIf="challengeForm.get('description')?.invalid">
            {{getErrorMessage('description')}}
          </mat-error>
        </mat-form-field>

        <!-- Points de récompense -->
        <mat-form-field appearance="outline">
          <mat-label>Points de récompense</mat-label>
          <input matInput type="number" formControlName="rewardPoints" 
                 placeholder="Nombre de points">
          <mat-error *ngIf="challengeForm.get('rewardPoints')?.invalid">
            {{getErrorMessage('rewardPoints')}}
          </mat-error>
        </mat-form-field>

        <!-- Badge -->
        <mat-form-field appearance="outline">
          <mat-label>Badge (optionnel)</mat-label>
          <mat-select formControlName="badge">
            <mat-option>Aucun</mat-option>
            <mat-option *ngFor="let badge of badges" [value]="badge">
              <div class="badge-option">
                <img [src]="badge.iconUrl" [alt]="badge.name" class="badge-icon">
                {{badge.name}}
              </div>
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Boutons -->
        <div class="form-actions">
          <button mat-button type="button" routerLink="/gamification/challenges">
            Annuler
          </button>
          <button mat-raised-button color="primary" type="submit" 
                  [disabled]="challengeForm.invalid || loading">
            <mat-spinner diameter="20" *ngIf="loading"></mat-spinner>
            <span *ngIf="!loading">Créer le challenge</span>
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>